üß™ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞: –í–∏—è–≤–ª–µ–Ω–Ω—è —ñ–Ω—Ü–∏–¥–µ–Ω—Ç—ñ–≤ –±–µ–∑–ø–µ–∫–∏ —É Splunk

 üéØ –ú–µ—Ç–∞
–ù–∞–≤—á–∏—Ç–∏—Å—è:
- –†–æ–∑–≥–æ—Ä—Ç–∞—Ç–∏ SIEM-—Å–∏—Å—Ç–µ–º—É Splunk —É Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ
- –ó–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ –ø—Ä–∏–∫–ª–∞–¥–∏ –ª–æ–≥—ñ–≤ —É Splunk
- –í–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –±–∞–∑–æ–≤–∏–π –∞–Ω–∞–ª—ñ–∑ –∂—É—Ä–Ω–∞–ª—ñ–≤ –ø–æ–¥—ñ–π
- –®—É–∫–∞—Ç–∏ –ø—ñ–¥–æ–∑—Ä—ñ–ª—É –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è PowerShell –¥–ª—è –∞—Ç–∞–∫ —Ç–∞ —ñ–Ω—à—ñ)
- –°—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –∞–ª–µ—Ä—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤–∏—è–≤–ª–µ–Ω–∏—Ö —à–∞–±–ª–æ–Ω—ñ–≤
- –ü–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ —Å–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—è –∞–ª–µ—Ä—Ç—ñ–≤ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –Ω–æ–≤–∏—Ö –ø–æ–¥—ñ–π
- –ó–∞–±–µ–∑–ø–µ—á—É–≤–∞—Ç–∏ —Å—Ç–∞–ª–∏–π –ø–æ—Ç—ñ–∫ –ª–æ–≥—ñ–≤ —ñ–∑ —ñ–Ω—à–æ—ó –º–∞—à–∏–Ω–∏ (—Ç–µ—Å—Ç–æ–≤–∏–π Linux)

---

üìò –ú–µ—Ç–æ–¥–∏—á–∫–∞ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤

–¶—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ —Ä–æ–∑—Ä–∞—Ö–æ–≤–∞–Ω–∞ –Ω–∞ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤, —è–∫—ñ **–Ω–µ –º–∞—é—Ç—å –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –¥–æ—Å–≤—ñ–¥—É –∑ Docker, Git –∞–±–æ Splunk**. –£—Å—ñ –∫–æ–º–∞–Ω–¥–∏ —Ç–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó —Å—É–ø—Ä–æ–≤–æ–¥–∂—É—é—Ç—å—Å—è –ø–æ—è—Å–Ω–µ–Ω–Ω—è–º–∏.

---

üß± –ß–∞—Å—Ç–∏–Ω–∞ 1. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞

üîß –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤
 1. üíª –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è Cursor IDE

Cursor ‚Äî —Ü–µ —ñ–Ω—Ç–µ–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞ IDE —ñ —á–∞—Ç –∞—Å–∏—Å—Ç–µ–Ω—Ç, —è–∫–∏–π –¥–æ–ø–æ–º–æ–∂–µ –∑—Ä–æ–∑—É–º—ñ—Ç–∏ –∫–æ–¥, —Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –∑–∞–ø–∏—Ç–∏ –¥–æ —Ç–µ—Ä–º—ñ–Ω–∞–ª—É, —Ç–æ—â–æ.

1.1. Windows:

1.1.1. –ó–∞–≤–∞–Ω—Ç–∞–∂–∏ –∑–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º: [https://www.cursor.so/](https://www.cursor.so/)
1.1.2. –í–∏–±–µ—Ä–∏ Windows Installer (.exe) —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏

1.2. macOS:

1.2.1. –ó–∞–≤–∞–Ω—Ç–∞–∂–∏ .dmg –∑ –æ—Ñ—ñ—Ü—ñ–π–Ω–æ–≥–æ —Å–∞–π—Ç—É
1.2.2. –í—ñ–¥–∫—Ä–∏–π .dmg —Ç–∞ –ø–µ—Ä–µ—Ç—è–≥–Ω–∏ Cursor –≤ Application

1.3. Linux (Ubuntu):

```bash
wget https://github.com/getcursor/cursor/releases/latest/download/cursor.deb
sudo dpkg -i cursor.deb
```

–ü—ñ—Å–ª—è —Ü—å–æ–≥–æ –∑–∞–ø—É—Å—Ç–∏ Cursor —è–∫ –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω—É IDE –∑ —á–∞—Ç–æ–º, —â–æ —Ä–æ–∑—É–º—ñ—î —Ç–µ—Ä–º—ñ–Ω–∞–ª —ñ —Å–∫—Ä–∏–ø—Ç–∏.


2. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ä–µ—à—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤:
2.1. ü™ü Windows:
2.1.1 –í—Å—Ç–∞–Ω–æ–≤–∏ **Docker Desktop**: [https://www.docker.com/products/docker-desktop/](https://www.docker.com/products/docker-desktop/)
   - –ü—ñ–¥ —á–∞—Å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —É–≤—ñ–º–∫–Ω–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫—É WSL2 (Windows Subsystem for Linux)
   - –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂ –∫–æ–º–ø‚Äô—é—Ç–µ—Ä –ø—ñ—Å–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

2.1.2 –í—Å—Ç–∞–Ω–æ–≤–∏ **Git for Windows**: [https://git-scm.com/download/win](https://git-scm.com/download/win)


2.2. üçé macOS:
2.2.1. –í—Å—Ç–∞–Ω–æ–≤–∏ **Docker Desktop for Mac**: [https://www.docker.com/products/docker-desktop/](https://www.docker.com/products/docker-desktop/)
   - –ü–æ—Ç—Ä—ñ–±–Ω–æ –º–∞—Ç–∏ macOS 11+ —ñ —á–∏–ø M1/M2 –∞–±–æ Intel

2.2.2. –í—Å—Ç–∞–Ω–æ–≤–∏ **Git** —á–µ—Ä–µ–∑ Homebrew:
```bash
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
brew install git
```

2.3.üêß Linux (Ubuntu/Debian):
```bash
sudo apt update && sudo apt install -y docker.io git
sudo systemctl enable docker && sudo systemctl start docker
sudo usermod -aG docker $USER
```
–ü—ñ—Å–ª—è —Ü—å–æ–≥–æ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂ —Å–∏—Å—Ç–µ–º—É –∞–±–æ –≤–∏–π–¥–∏ –π –∑–∞–π–¥–∏ –∑–Ω–æ–≤—É, —â–æ–± –∑–∞—Å—Ç–æ—Å—É–≤–∞–ª–∏—Å—å –∑–º—ñ–Ω–∏.

---

üì¶ –ß–∞—Å—Ç–∏–Ω–∞ 2. –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ—ó

```bash
git clone https://github.com/AleVak/splunk-incident-lab.git
cd splunk-incident-lab
```

*–Ø–∫—â–æ —É –≤–∞—Å –Ω–µ–º–∞—î GitHub-–∞–∫–∞—É–Ω—Ç–∞ ‚Äî –ø—Ä–æ—Å—Ç–æ –∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ `.zip` –∑ GitHub —Ç–∞ —Ä–æ–∑–ø–∞–∫—É–π—Ç–µ.*

---

üê≥ –ß–∞—Å—Ç–∏–Ω–∞ 3. –ó–∞–ø—É—Å–∫ Splunk —É Docker

```bash
docker-compose up -d
```

‚è≥ –ó–∞—á–µ–∫–∞–π 1‚Äì2 —Ö–≤–∏–ª–∏–Ω–∏, –ø–æ–∫–∏ Splunk –ø–æ–≤–Ω—ñ—Å—Ç—é –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è.

–ü–æ—Ç—ñ–º –≤—ñ–¥–∫—Ä–∏–π –±—Ä–∞—É–∑–µ—Ä —ñ –ø–µ—Ä–µ–π–¥—ñ—Ç—å –∑–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º: [http://localhost:8000](http://localhost:8000)

- –Ü–º‚Äô—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞: `admin`
- –ü–∞—Ä–æ–ª—å: `changeme`

> –Ø–∫—â–æ –Ω–µ –≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è ‚Äî –ø–µ—Ä–µ–≤—ñ—Ä, —á–∏ Docker –ø—Ä–∞—Ü—é—î, —ñ –ø–æ–≤—Ç–æ—Ä–∏ `docker-compose up -d`

---

üìÇ –ß–∞—Å—Ç–∏–Ω–∞ 4. –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ª–æ–≥—ñ–≤ —Ç–∞ –æ–∑–Ω–∞–π–º–ª–µ–Ω–Ω—è –∑ use cases

–Ø–∫ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –æ–¥–Ω—Ä–æ—Ä–∞–∑–æ–≤–æ –ª–æ–≥–∏ - instructions/02_upload_logs.md
–û–∑–Ω–∞–π–º–ª–µ–Ω–Ω—è –∑ use cases - instructions/2_use_cases.md

---

üîé –ß–∞—Å—Ç–∏–Ω–∞ 5. –ù–∞–ø–∏—Å–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—É SPL (Search Processing Language)

–í Splunk –∑–∞–π–¥–∏ –≤ `Search & Reporting` ‚Üí —Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π –ø–æ—à—É–∫:

```spl
index=main sourcetype=sysmon Image=*powershell.exe* CommandLine="*-enc*"
```


üîç –¶–µ–π –∑–∞–ø–∏—Ç —à—É–∫–∞—Ç–∏–º–µ –≤—Å—ñ –ø–æ–¥—ñ—ó, –¥–µ –∑–∞–ø—É—Å–∫–∞–≤—Å—è PowerShell —ñ–∑ –∑–∞–∫–æ–¥–æ–≤–∞–Ω–æ—é –∫–æ–º–∞–Ω–¥–æ—é (—á–∞—Å—Ç–∏–π —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä —à–∫—ñ–¥–ª–∏–≤–æ—ó –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ).

!!! –†–µ—à—Ç–∞ spl –∑–∞–ø–∏—Ç—ñ–≤ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è —Ç—É—Ç - spl_queries/ !!!

‚úÖ –ú–æ–∂–Ω–∞ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –¥–µ—Ç–∞–ª—ñ –ø–æ–¥—ñ—ó, –Ω–∞—Ç–∏—Å–Ω—É–≤—à–∏ –Ω–∞ –∑–∞–ø–∏—Å —É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö.

---

üö® –ß–∞—Å—Ç–∏–Ω–∞ 6. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∞–ª–µ—Ä—Ç—É

1. –£ –≤—ñ–∫–Ω—ñ –ø–æ—à—É–∫—É –Ω–∞—Ç–∏—Å–Ω–∏ **Save As** ‚Üí **Alert**
2. –í–≤–µ–¥–∏ –Ω–∞–∑–≤—É: `Suspicious PowerShell Alert` —Ä–µ—à—Ç–∞ –∞–ª–µ—Ä—Ç—ñ–≤ –Ω–∞–∑–∏–≤–∞—î–º–æ –ø–æ —ñ–º–µ–Ω—ñ –∞—Ç–∞–∫–∏
3. –£–º–æ–≤–∞ —Å–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—è: `If number of results > 0`
4. –ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è: `Every 5 minutes`
5. Alert Type: **Scheduled Alert**
6. Action: –º–æ–∂–µ—à –ø–æ–∫–∏ –∑–∞–ª–∏—à–∏—Ç–∏ –±–µ–∑ email ‚Äî –ª–∏—à–µ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —É –∂—É—Ä–Ω–∞–ª—ñ
7. –ù–∞—Ç–∏—Å–Ω–∏ Save

–Ø–∫ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –∞–ª–µ—Ä—Ç—ñ–Ω–≥ - instructions/04_alert_config.md
---

üß™ –ß–∞—Å—Ç–∏–Ω–∞ 7. –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∞–ª–µ—Ä—Ç—É

1. –Ü–º–ø–æ—Ä—Ç—É–π —â–µ —Ä–∞–∑ –ª–æ–≥ –∑ –ø–æ–¥—ñ–±–Ω–æ—é –ø–æ–¥—ñ—î—é, –∞–±–æ –∑–º—ñ–Ω–µ–Ω–∏–π –ª–æ–≥, –¥–µ —î –∑–∞–∫–æ–¥–æ–≤–∞–Ω–∞ –∫–æ–º–∞–Ω–¥–∞
2. –ó–∞—á–µ–∫–∞–π 5 —Ö–≤–∏–ª–∏–Ω (–∞–±–æ –Ω–∞—Ç–∏—Å–Ω–∏ "Run Alert Now")
3. –ü–µ—Ä–µ–≤—ñ—Ä, —á–∏ –∞–ª–µ—Ä—Ç –∑‚Äô—è–≤–∏–≤—Å—è –≤ `Activity ‚Üí Triggered Alerts`

---

üì§ –ß–∞—Å—Ç–∏–Ω–∞ 8. –ó–≤—ñ—Ç–Ω—ñ—Å—Ç—å

üîñ –ü–æ—Ç—Ä—ñ–±–Ω–æ –ø—ñ–¥–≥–æ—Ç—É–≤–∞—Ç–∏:
- `.spl` —Ñ–∞–π–ª –∞–±–æ —Ç–µ–∫—Å—Ç –ø–æ—à—É–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Ç—É
- –°–∫—Ä–∏–Ω—à–æ—Ç–∏:
  - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –ø–æ—à—É–∫—É
  - –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∞–ª–µ—Ä—Ç—É
  - –º–æ–º–µ–Ω—Ç—É —Å–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—è (Triggered Alert)
- –ó–≤—ñ—Ç —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF 

---

üí° –ü–æ—Ä–∞–¥–∏
- –ù–µ –∑–∞–±—É–¥—å –≤–∏–º–∫–Ω—É—Ç–∏ Splunk –ø—ñ—Å–ª—è —Ä–æ–±–æ—Ç–∏:
```bash
docker-compose down
```
- –Ø–∫—â–æ Docker –≤–∏–¥–∞—î –ø–æ–º–∏–ª–∫–∏ ‚Äî –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Å—è, —â–æ –≤—ñ–Ω –ø—Ä–∞—Ü—é—î, —Ç–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—É
- –Ø–∫—â–æ Splunk –¥–æ–≤–≥–æ –≤–∞–Ω—Ç–∞–∂–∏—Ç—å—Å—è ‚Äî –∑–∞—á–µ–∫–∞–π, —Ü–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –ø–µ—Ä—à–æ–≥–æ –∑–∞–ø—É—Å–∫—É

---

!!! –¶–µ –æ–ø—Ü—ñ–π–Ω–æ, –Ω–µ –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏

‚ö°Ô∏è Advanced: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å—Ç–∞–ª–æ–≥–æ —Å—Ç—Ä—ñ–º—ñ–Ω–≥—É –ª–æ–≥—ñ–≤ —ñ–∑ —Ç–µ—Å—Ç–æ–≤–æ—ó Linux-–º–∞—à–∏–Ω–∏

1. –°–∫–æ–ø—ñ—é–π —Ç–∞ –ø–æ–∑–∞–ø—É—Å–∫–∞–π `Dockerfile.uf-test` (–¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ Linux –∑ Splunk Universal Forwarder):

```bash
docker build -f Dockerfile.uf-test -t uf-linux .
docker run -it uf-linux
```

2. –£–≤–µ—Å—å –∑–ª–∏–≤ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è —á–µ—Ä–µ–∑ HEC (HTTP Event Collector) –∞–±–æ –∑–∞–≤–¥—è–∫–∏ Universal Forwarder
3. –£–ø–µ–≤–Ω–∏—Å—å, —â–æ —Ç–æ–∫–µ–Ω HEC –≤—Å—Ç–∞–≤–ª–µ–Ω–æ –≤ —Å–∫—Ä–∏–ø—Ç –∞–±–æ –≤–∫–æ–Ω—Ñ—ñ–≥—É—Ä–æ–≤–∞–Ω–æ forwarder –Ω–∞ –ø–æ—Ä—Ç 9997

> –¶–µ –¥–æ–∑–≤–æ–ª–∏—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ Splunk —è–∫ —Ä–µ–∞–ª—å–Ω—É SIEM —Å–∏—Å—Ç–µ–º—É, —â–æ –∑–±–∏—Ä–∞—î –ª–æ–≥–∏ –∑ —ñ–Ω—à–∏—Ö —Ö–æ—Å—Ç—ñ–≤.


