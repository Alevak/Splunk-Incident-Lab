# syntax=docker/dockerfile:1

FROM --platform=linux/amd64 ubuntu:22.04

# Оновлення та залежності
RUN apt-get update && \
    apt-get install -y wget curl gnupg2 systemctl net-tools iputils-ping && \
    apt-get clean

# Завантаження та встановлення Splunk UF
RUN wget -O splunkforwarder.tgz 'https://download.splunk.com/products/universalforwarder/releases/10.0.0/linux/splunkforwarder-10.0.0-e8eb0c4654f8-linux-amd64.tgz' && \
    tar -xvzf splunkforwarder.tgz && \
    mv splunkforwarder /opt/splunkforwarder && \
    rm splunkforwarder.tgz

# Копіюємо стартовий скрипт
COPY entrypoint.sh /entrypoint.sh
RUN chmod +x /entrypoint.sh

# Вказуємо робочу директорію
WORKDIR /opt/splunkforwarder

# Запуск через entrypoint
ENTRYPOINT ["/entrypoint.sh"]
