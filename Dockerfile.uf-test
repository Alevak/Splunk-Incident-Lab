FROM ubuntu:22.04

ENV DEBIAN_FRONTEND=noninteractive

# üîß –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
RUN apt-get update && apt-get install -y wget curl gnupg2 apt-transport-https ca-certificates lsb-release

# üì• –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è Splunk Universal Forwarder
RUN wget -O splunkforwarder.tgz 'https://download.splunk.com/products/universalforwarder/releases/10.1.1/linux/splunkforwarder-10.1.1-e21634c0c686-Linux-x86_64.tgz' && \
    tar -xvzf splunkforwarder.tgz && \
    mv splunkforwarder /opt/splunkforwarder && \
    rm splunkforwarder.tgz

# ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç—É –∑–∞–ø—É—Å–∫—É
COPY entrypoint.sh /entrypoint.sh
RUN chmod +x /entrypoint.sh

# üõ° –í—ñ–¥–∫—Ä–∏—Ç—Ç—è –ø–æ—Ä—Ç—ñ–≤ (–æ–ø—Ü—ñ–π–Ω–æ, –±–æ –ø—Ä–∞—Ü—é—î–º–æ —è–∫ –∞–≥–µ–Ω—Ç)
EXPOSE 8089 9997

# üìç –†–æ–±–æ—á–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è
WORKDIR /opt/splunkforwarder

# üöÄ –ó–∞–ø—É—Å–∫ Forwarder –∑ –∞–≤—Ç–æ–∫–æ–Ω—Ñ—ñ–≥–æ–º
ENTRYPOINT ["/entrypoint.sh"]
