Опис юс-кейсів SPL (українською мовою)

---

1. `linux_sudo_nopasswd.spl`

Юс-кейс: Виявлення конфігурації `sudo`, яка дозволяє виконання root-команд без пароля.

Чому це небезпечно: 
Дозвіл `NOPASSWD` у файлі конфігурації `/etc/sudoers` дозволяє користувачам підвищувати привілеї без введення пароля. Цю конфігурацію часто використовують зловмисники після отримання доступу з низькими привілеями для прихованого підвищення прав.

SPL-запит:
```spl
source="linux_sudo_nopasswd.json" index="main" sourcetype="_json" auth="NOPASSWD"
```

Логіка виявлення:  
Пошук у логах подій, що містять `NOPASSWD` у контексті редагування файлу `sudoers` або конфігурації `sudo`. Такі події вказують на потенційне порушення принципу найменших привілеїв або вектор ескалації.

---

2. `linux_tmp_exec.spl`

Юс-кейс: Виявлення виконання скриптів чи бінарних файлів з директорії `/tmp`.

Чому це небезпечно:  
Каталог `/tmp` має права на запис для всіх користувачів і часто використовується зловмисниками для завантаження або виконання шкідливих файлів. Легітимні застосунки рідко виконують файли з цієї директорії.

SPL-запит:
```spl
source="linux_tmp_exec.json" sourcetype="_json" exec="/tmp/malware.sh"
```

Логіка виявлення:  
Пошук виконання скриптів або бінарних файлів, які були запущені з `/tmp`. Це типовий TTP у багатьох Linux-зловмисних кампаніях.

---

3. `network_dns_duckdns.spl`

Юс-кейс: Виявлення DNS-запитів до динамічного DNS-провайдера `duckdns.org`.

Чому це небезпечно:  
`duckdns.org` часто використовується для C2 (Command and Control) через простоту реєстрації та гнучке зіставлення з IP. Часті запити до цього домену можуть вказувати на маячкову активність шкідливого ПЗ.

SPL-запит:
```spl
source="network_dns_duckdns.json" index="main" sourcetype="_json" query="*.duckdns.org"
```

Логіка виявлення:  
Пошук вихідних DNS-запитів, що містять `duckdns.org`, дозволяє виявляти C2-активність або тунелювання до інфраструктури атакувальника.

---
4. `suspicious_powershell.spl`

Юс-кейс: Виявлення підозрілих PowerShell-команд.

**Чому це небезпечно:**  
PowerShell — потужний інструмент адміністрування, який часто використовують атакувальники для запуску скриптів, завантаження шкідливого коду та обходу захисту (через обфускацію або кодування у base64).

SPL-запит:
```spl
source="sysmon_powershell_base64.json" index="main" sourcetype="_json" command_line="*-enc*"
```

Логіка виявлення:  
Пошук ознак зловживання PowerShell, зокрема через закодовані вмісти. Такі події зазвичай пов’язані з початковим доступом і виконанням скриптів (MITRE ATT&CK Initial Access / Execution).

---

5. `sysmon_bruteforce.spl`

Юс-кейс: Виявлення brute-force атаки в Windows на основі подій про невдалі входи.

Чому це небезпечно:  
Кілька невдалих спроб входу (Event ID 4625) за короткий проміжок часу можуть свідчити про brute-force атаку для отримання несанкціонованого доступу.

SPL-запит:
```spl
source="bruteforce_sample_mixed.json" sourcetype="_json" EventID="4625"
| bin _time span=1h
| stats count as failed_attempts by IpAddress, UserName, _time
| where failed_attempts >= 3
| sort - failed_attempts
```

Логіка виявлення: 
Корелюємо кілька невдалих входів із тієї ж IP-адреси або по одному імені користувача. Поріг `>= 3` дозволяє відсіяти шум і зафіксувати підозрілу активність, що вказує на brute-force.
